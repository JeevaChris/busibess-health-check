<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BizVitals 360 - Assessment</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>Business Health Assessment</header>
  <div class="container">
    <form id="assessment-section">
      <div id="questions-container"></div>
      <div class="action-buttons">
        <button type="button" onclick="saveAssessment()">💾 Save</button>
        <button type="submit" id="submitBtn" style="display:none">🚀 Submit</button>
      </div>
    </form>
    <div id="score-output" style="margin-top: 30px; font-size: 1.2rem; font-weight: bold;"></div>
  </div>

  <script>
    const groupedQuestions = {
      "Revenue & Profitability": {
        "Sales Growth": [
          "Are you getting more sales or customers than you did last year?",
          "Do you track revenue trends by product, service, or region?"
        ],
        "Customer Dependence": [
          "Are you less dependent on a single customer or product?",
          "Is your pricing strategy aligned with customer value and market position?"
        ],
        "Profit Margins": [
          "Have your profit margins improved or stayed stable in the past 12 months?",
          "Could your business stay profitable if revenue dropped by 10%?",
          "Are you regularly reviewing financial reports to assess profit trends?"
        ]
      },
      "Cash Flow & Liquidity": {
        "Cash Management": [
          "Can you handle your regular business expenses without borrowing or delays?",
          "Do you have some money saved to manage slow months or emergencies?"
        ],
        "Tracking & Forecasting": [
          "Do you know how much money is coming in and going out every month?",
          "Do you forecast your cash flow at least monthly?"
        ],
        "Access & Separation": [
          "Can you access funds quickly in case of a cash crunch?",
          "Have you separated personal and business finances completely?",
          "Do you avoid frequent reliance on credit for regular expenses?",
          "Do you consistently generate more cash than you spend each month?"
        ]
      },
      "Cost & Expense Management": {
        "Cost Value Analysis": [
          "Are most of your costs helping your business grow or run better?",
          "Could you reduce spending quickly if needed, without hurting your business?"
        ],
        "Budgeting & Tracking": [
          "Do you track your spending against a monthly or quarterly budget?",
          "Do you review expense reports or accounts monthly?"
        ],
        "Vendor Review": [
          "Do you routinely review and optimize supplier and vendor contracts?",
          "Have you identified your top 3 cost drivers in the business?",
          "Do you run a break-even analysis when planning large expenses?"
        ]
      },
      "Working Capital & Efficiency": {
        "Receivables": [
          "Do your customers usually pay you on time?",
          "Are most of your invoices paid within 30 days?"
        ],
        "Payables & Continuity": [
          "Can you pay your suppliers and bills on time without waiting for new income?",
          "Could your business keep running for a few months if sales dropped suddenly?"
        ],
        "Inventory & Conversion": [
          "Do you keep enough inventory to meet demand without overstocking?",
          "Do you review how quickly you convert inventory into sales?"
        ],
        "Cycle Optimization": [
          "Are your payable and receivable cycles optimized to avoid cash gaps?",
          "Do you monitor short-term assets and liabilities monthly?"
        ]
      }
    };

    const scoringMap = { "Yes": 10, "In Process": 5, "No": 0, "N/A": 0 };

    function generateQuestions() {
      const container = document.getElementById("questions-container");
      container.innerHTML = "";
      let index = 0;

      for (const mainCat in groupedQuestions) {
        const mainTitle = document.createElement("h2");
        mainTitle.textContent = mainCat;
        mainTitle.style.color = "#2b8a3e";
        container.appendChild(mainTitle);

        const subCats = groupedQuestions[mainCat];
        for (const subCat in subCats) {
          const subTitle = document.createElement("h3");
          subTitle.textContent = "➤ " + subCat;
          subTitle.style.color = "#444";
          container.appendChild(subTitle);

          subCats[subCat].forEach(q => {
            const div = document.createElement("div");
            div.className = "question-block";
            if (index === 0) div.classList.add("active");
            div.innerHTML = `
              <p><strong>(${index + 1})</strong> ${q}</p>
              <label><input type="radio" name="q${index}" value="Yes"> ✅ Yes</label>
              <label><input type="radio" name="q${index}" value="In Process"> 🔄 In Process</label>
              <label><input type="radio" name="q${index}" value="No"> ❌ No</label>
              <label><input type="radio" name="q${index}" value="N/A"> 🔘 N/A</label>
              <button type="button" onclick="showNext(${index})">Next</button>
            `;
            container.appendChild(div);
            index++;
          });
        }
      }
    }

    function showNext(current) {
      const blocks = document.querySelectorAll('.question-block');
      const selected = blocks[current].querySelector('input[type="radio"]:checked');
      if (!selected) return alert("Please select an option.");
      blocks[current].classList.remove("active");
      if (blocks[current + 1]) {
        blocks[current + 1].classList.add("active");
      } else {
        document.getElementById("submitBtn").style.display = "inline-block";
      }
    }

    function saveAssessment() {
      const radios = document.querySelectorAll('input[type="radio"]:checked');
      let score = 0;
      radios.forEach(r => {
        score += scoringMap[r.value];
      });
      localStorage.setItem("bizvitals_score", score);
      alert("✅ Your answers have been saved.");
    }

    document.getElementById("assessment-section").addEventListener("submit", function (e) {
      e.preventDefault();
      const radios = document.querySelectorAll('input[type="radio"]:checked');
      let score = 0;
      radios.forEach(r => {
        score += scoringMap[r.value];
      });
      const totalQuestions = document.querySelectorAll(".question-block").length;
      const maxScore = totalQuestions * 10;
      const percent = ((score / maxScore) * 100).toFixed(1);
      localStorage.setItem("bizvitals_score", score);

      document.getElementById("score-output").innerHTML =
        `🎯 Your Score: <strong>${score}/${maxScore}</strong> (${percent}%)`;
    });

    window.onload = generateQuestions;
  </script>
</body>
</html>
